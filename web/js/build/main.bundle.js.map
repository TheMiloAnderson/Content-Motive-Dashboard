{"version":3,"sources":["webpack:///webpack/bootstrap 804c4f80220d16d793e4","webpack:///./web/js/main.js","webpack:///./web/js/dashboard.js"],"names":["calculateMonthlyPayment","principal","years","rate","monthlyRate","monthlyPayment","Math","pow","calculateAmortization","balance","amortization","y","interestY","principalY","m","interestM","principalM","push","document","getElementById","addEventListener","value","innerHTML","toFixed","forEach","console","log","month","dashboard","prms","width","d3","select","node","getBoundingClientRect","height","x","duration","dataLines","lineWidth","pageViewColor","uniqueVisitorColor","entrancesColor","opacity","margin","top","right","bottom","left","dateGuideOpacity","ajaxUrl","dataCache","dataset","dataSubset","dealersList","mainChart","g","bottomAxis","leftAxis","startDateGuide","endDateGuide","xScale","yScale","dealerSubhead","jQuery","websiteSubhead","dealersSelectTitle","websitesSelectTitle","dealerSelect","dateRangeBtn","dateRangeResetBtn","dateSlider","startDateField","endDateField","propertyRows","detailsTable","initUi","click","closeMenu","pid","attr","split","i","length","revisedDataset","filter","d","includes","property_id","prepData","updateChart","detailTables","resetDateSlider","e","preventDefault","dealerId","id","changeData","on","start","Date","val","getTime","slider","data","end","startDate","$","endDate","revisedData","date_recorded","el","collapse","updateSiteSelect","siteSelect","find","css","dByUrl","getCurrentSites","pids","row","join","sites","url","getFullYear","getMonth","slice","getDate","get","show","html","updateSubheads","dealer_id","dealer","grep","obj","text","named","textContent","sitesText","animate","map","uniqueSites","Array","from","Set","s","initializeDateSlider","min","max","addDateGuide","append","range","step","values","slide","event","ui","setDateFields","callback","ajax","dataType","method","success","JSON","parse","error","xhr","parseTime","timeParse","tot_pageviews","tot_visitors","tot_entrances","pageviews","visitors","entrances","avg_time","bounce_rate","metricReadouts","transition","tween","element","f","format","newValue","interpolateNumber","replace","t","Number","avg_seconds","floor","makeTime","time","sec","breakTime","totalSec","elementText","bounceRate","createChart","g2","addPath","lineClass","txt","txtId","color","svg","scaleTime","domain","extent","yDomainMin","yDomainMax","scaleLinear","formatDay","timeFormat","formatWeek","formatMonth","formatYear","multiFormat","date","timeMonth","timeWeek","timeYear","axisBottom","ticks","tickFormat","tickPadding","tickSizeInner","tickSizeOuter","call","axisLeft","lineTransitions","formatTicks","dataCol","lineD","area","y1","y0","originalPath","substring","pathCoordinates1","pathCoordinates2","endLine","secondSegment","lineLength","coords","coordsObj","simplify","increment","item","splice","attrTween","previous","current","exclude","a","b","interpolatePath","selectAll","style","timer","isNaN","resizeId","window","clearTimeout","setTimeout","resize","parseInt","init","dealers"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 804c4f80220d16d793e4","let calculateMonthlyPayment = (principal, years, rate) => {\r\n\tlet monthlyRate = 0;\r\n    if (rate) {\r\n        monthlyRate = rate / 100 / 12;\r\n    }\r\n    let monthlyPayment = principal * monthlyRate / (1 - (Math.pow(1 / (1 + monthlyRate), years * 12)));\r\n    return {principal, years, rate, monthlyPayment, monthlyRate};\r\n};\r\n\r\nlet calculateAmortization = (principal, years, rate) => {\r\n\tlet {monthlyRate, monthlyPayment} = calculateMonthlyPayment(principal, years, rate);\r\n\tlet balance = principal;\r\n\tlet amortization = [];\r\n\tfor (let y=0; y<years; y++) {\r\n\t\tlet interestY = 0;\r\n\t\tlet principalY = 0;\r\n\t\tfor (let m=0; m<12; m++) {\r\n\t\t\tlet interestM = balance * monthlyRate;\r\n\t\t\tlet principalM = monthlyPayment - interestM;\r\n\t\t\tinterestY = interestY + interestM;\r\n\t\t\tprincipalY = principalY + principalM;\r\n\t\t\tbalance = balance - principalM;\r\n\t\t}\r\n\t\tamortization.push({principalY, interestY, balance});\r\n\t}\r\n\treturn {monthlyPayment, monthlyRate, amortization};\r\n};\r\n\r\ndocument.getElementById('calcBtn').addEventListener('click', () => {\r\n    let principal = document.getElementById(\"principal\").value;\r\n    let years = document.getElementById(\"years\").value;\r\n    let rate = document.getElementById(\"rate\").value;\r\n    let {monthlyPayment, monthlyRate, amortization} = calculateAmortization(principal, years, rate);\r\n    document.getElementById(\"monthlyPayment\").innerHTML = monthlyPayment.toFixed(2);\r\n\tdocument.getElementById(\"monthlyRate\").innerHTML = (monthlyRate * 100).toFixed(2);\r\n\tamortization.forEach(month => console.log(month));\r\n});\n\n\n// WEBPACK FOOTER //\n// ./web/js/main.js","var dashboard = (function() {\r\n    'use strict';\r\n    //***** Parameters & global variables *****//\r\n    var prms = {\r\n        width: d3.select('#chart-box #chart').node().getBoundingClientRect().width,\r\n        height: 400,\r\n        x: 50,\r\n        y: 50,\r\n        duration: 1500,\r\n        dataLines: {\r\n            lineWidth: 1,\r\n            pageViewColor: 'steelblue',\r\n            uniqueVisitorColor: 'midnightblue',\r\n            entrancesColor: 'darkred',\r\n            opacity: 0.7\r\n        },\r\n        margin: {\r\n            top: 20,\r\n            right: 45,\r\n            bottom: 45,\r\n            left: 80\r\n        },\r\n        dateGuideOpacity: 0.3\r\n    };\r\n    var ajaxUrl,\r\n        dataCache = [], // all data for a user (eventually)\r\n        dataset = [], // all data for a dealer\r\n        dataSubset = [], // dealer data filtered by date or website\r\n        dealersList = [],\r\n        mainChart,\r\n        g,\r\n        bottomAxis,\r\n        leftAxis,\r\n        startDateGuide,\r\n        endDateGuide,\r\n        height,\r\n        width,\r\n        xScale,\r\n        yScale;\r\n\r\n    var dealerSubhead = jQuery('span#dealerSubhead');\r\n    var websiteSubhead = jQuery('#websiteSubhead');\r\n    \r\n    var dealersSelectTitle = document.getElementById('dealersSelectTitle');\r\n    var websitesSelectTitle = document.getElementById('websitesSelectTitle');\r\n    \r\n    var dealerSelect = jQuery('.dealerSelect');\r\n    var dateRangeBtn = jQuery('#dateRangeBtn');\r\n    var dateRangeResetBtn = jQuery('#dateRangeResetBtn');\r\n    var dateSlider = jQuery('#slider-range');\r\n    var startDateField = jQuery('#startDate');\r\n    var endDateField = jQuery('#endDate');\r\n    \r\n    var propertyRows = jQuery('.propertyFilter');\r\n    var detailsTable = jQuery('#p0');\r\n    \r\n    //***** UI controls *****//\r\n    //\r\n    function initUi() {\r\n        propertyRows.click(function() {\r\n            closeMenu('#websites');\r\n            var pid = jQuery(this).attr('data-properties').split(',');\r\n            for (var i=0; i<pid.length; i++) {pid[i] = +pid[i]; }\r\n            var revisedDataset = dataset.filter(function(d) {\r\n                return pid.includes(d.property_id);\r\n            });\r\n            dataSubset = prepData(revisedDataset);\r\n            updateChart(dataSubset);\r\n            detailTables(dataSubset);\r\n            resetDateSlider(dataSubset);\r\n        });\r\n        // Click dealer/host names, get new dataset\r\n        dealerSelect.click(function(e) {\r\n            e.preventDefault();\r\n            var dealerId = this.dataset.id;\r\n            closeMenu('#dealers');\r\n            ajaxUrl = jQuery(this).attr('href');\r\n            changeData(function() {\r\n                updateChart(dataset);\r\n                detailTables(dataset);\r\n                resetDateSlider(dataset);\r\n            }, dealerId);\r\n        });\r\n        // Filter dataset by date, update the chart\r\n        startDateField.on('change', function() {\r\n            var start = new Date(startDateField.val()).getTime();\r\n            dateSlider.slider('values', 0, start / 1000);\r\n            dateRangeBtn.data('startdate', start);\r\n            startDateGuide.attr('width', xScale(start));\r\n        });\r\n        endDateField.on('change', function() {\r\n            var end = new Date(endDateField.val()).getTime();\r\n            dateSlider.slider('values', 1, end / 1000);\r\n            dateRangeBtn.data('enddate', end);\r\n            endDateGuide.attr('width', width - xScale(end)).attr('x', xScale(end));\r\n        });\r\n        dateRangeBtn.click(function() {\r\n            var startDate = $(this).data('startdate');\r\n            var endDate = $(this).data('enddate');\r\n            var revisedData = dataSubset.filter(function(d) {\r\n                return d.date_recorded >= startDate && d.date_recorded <= endDate;\r\n            });\r\n            updateChart(prepData(revisedData));\r\n            detailTables(prepData(revisedData), startDate, endDate);\r\n        });\r\n        dateRangeResetBtn.click(function() {\r\n            var d = prepData(dataset);\r\n            updateChart(d);\r\n            detailTables(d);\r\n            resetDateSlider(d);\r\n        });\r\n    }\r\n    function closeMenu(id) {\r\n        var el = jQuery(id);\r\n        el.collapse('toggle');\r\n    }\r\n    function updateSiteSelect(d) {\r\n        var siteSelect = jQuery('#websites');\r\n        siteSelect.find('.propertyFilter').css('display', 'none');\r\n        var dByUrl = getCurrentSites(d);\r\n        if (dByUrl.length < 2) { \r\n            siteSelect.css('display', 'none');\r\n            jQuery('#websites-head').css('display', 'none');\r\n        } else {\r\n            siteSelect.css('display', '');\r\n            var pids = [];\r\n            for (var i=0; i<dByUrl.length; i++) {\r\n                    var row = jQuery(\"li[data-properties='\" + dByUrl[i][1] + \"']\");\r\n                    row.css('display', '');\r\n                    pids.push(dByUrl[i][1]);\r\n                }\r\n            jQuery('#websites-head').css('display', '');\r\n            jQuery('.allWebsites').css('display', '');\r\n            jQuery('.propertyFilter.allWebsites').attr('data-properties', pids.join());\r\n        }\r\n    }\r\n    function detailTables(d, start = false, end = false) {\r\n        var sites = getCurrentSites(d);\r\n        var url = '?r=/dashboard/details&';\r\n        for (var i=0; i < sites.length; i++) {\r\n            url += 'pids[' + i +  ']=' + sites[i][1] + '&';\r\n        }\r\n        if (start) { \r\n            start = start.getFullYear() + '-' + ('0' + (start.getMonth() + 1)).slice(-2) + '-' + ('0' + start.getDate()).slice(-2);\r\n            url += 'start=' + start + '&';\r\n        }\r\n        if (end) { \r\n            end = end.getFullYear() + '-' + ('0' + (end.getMonth() + 1)).slice(-2) + '-' + ('0' + end.getDate()).slice(-2);\r\n            url += 'end=' + end + '&';\r\n        }\r\n        jQuery.get(url, function(data) {\r\n            data = '<div id=\"p0\">' + data + '</div>';\r\n            detailsTable.show();\r\n            detailsTable.html(data);\r\n        });\r\n    }\r\n    function updateSubheads(d) {\r\n        var id = d[0].dealer_id;\r\n        var dealer = jQuery.grep(dealersList, function(obj) { return obj.id === id; });\r\n        dealerSubhead.text(dealer[0].named);\r\n        dealersSelectTitle.textContent = dealer[0].named;\r\n        \r\n        var sites = getCurrentSites(d);\r\n        var sitesText = sites.length === 1 ? sites[0][0] : 'All Websites';\r\n        websiteSubhead.animate({opacity: 0}, 200, function() { \r\n            websiteSubhead.text(sitesText);\r\n            websiteSubhead.animate({opacity: 1}, 300);\r\n        });\r\n        websitesSelectTitle.textContent = sitesText;\r\n    }\r\n    function getCurrentSites(d) {\r\n        var sites = d.map(function(d) { return d.url + '__' + d.property_id; });\r\n        var uniqueSites = Array.from(new Set(sites));\r\n        return uniqueSites.map(function(s) { return [s.split('__')[0], s.split('__')[1]];});\r\n    }\r\n    function initializeDateSlider() {\r\n        var min = new Date(dataset[0].date_recorded).getTime() / 1000;\r\n        var max = new Date(dataset[dataset.length - 1].date_recorded).getTime() / 1000;\r\n        function addDateGuide(id) {\r\n            return g.append('rect')\r\n                .attr('id', id)\r\n                .attr('height', height)\r\n                .attr('width', 0)\r\n                .attr('fill', 'black')\r\n                .attr('opacity', prms.dateGuideOpacity)\r\n            ;\r\n        }\r\n        startDateGuide = addDateGuide('startDateGuide');\r\n        endDateGuide = addDateGuide('endDateGuide');\r\n        dateSlider.slider({\r\n            range: true,\r\n            min: min,\r\n            max: max,\r\n            step: 86400,\r\n            get values () {\r\n                return [this.min, this.max];\r\n            },\r\n            slide: function(event, ui) {\r\n                var startDate = new Date(ui.values[0] * 1000);\r\n                var endDate = new Date(ui.values[1] * 1000);\r\n                setDateFields(startDate, endDate);\r\n                dateRangeBtn.data('startdate', startDate);\r\n                dateRangeBtn.data('enddate', endDate);\r\n                startDateGuide.attr('width', xScale(startDate));\r\n                endDateGuide.attr('width', width - xScale(endDate)).attr('x', xScale(endDate));\r\n            }\r\n        });\r\n        resetDateSlider(dataset);\r\n    }\r\n    function resetDateSlider(d) {\r\n        var start = new Date(d[0].date_recorded).getTime();\r\n        var end = new Date(d[d.length - 1].date_recorded).getTime();\r\n        dateSlider.slider('option', 'min', start / 1000);\r\n        dateSlider.slider('option', 'max', end / 1000);\r\n        dateSlider.slider('values', 0, start / 1000);\r\n        dateSlider.slider('values', 1, end / 1000);\r\n        dateRangeBtn.data('startdate', start);\r\n        dateRangeBtn.data('enddate', end);\r\n        setDateFields(start, end);\r\n    }\r\n    function setDateFields(start, end) {\r\n        start = new Date(start);\r\n        end = new Date(end);\r\n        startDateField.val(('0' + (start.getMonth() + 1)).slice(-2) + '/' + ('0' + start.getDate()).slice(-2) + '/' + start.getFullYear());\r\n        endDateField.val(('0' + (end.getMonth() + 1)).slice(-2) + '/' + ('0' + end.getDate()).slice(-2) + '/' + end.getFullYear());\r\n    }\r\n    \r\n    //***** Data processing & display *****//\r\n    function changeData(callback, id) {\r\n        if (dataCache[id]) {\r\n            dataset = dataCache[id];\r\n            callback();\r\n            dataSubset = dataset;\r\n        } else {\r\n            $.ajax({\r\n                url: ajaxUrl,\r\n                dataType: 'text',\r\n                method: 'GET',\r\n                success: function(data) {\r\n                    data = JSON.parse(data);\r\n                    dataset = prepData(data);\r\n                    callback();\r\n                    dataCache[id] = dataSubset = dataset;\r\n                },\r\n                error:  function(xhr) {\r\n                    console.log(xhr);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    function prepData(data) {\r\n        var parseTime = d3.timeParse(\"%Y-%m-%d\");\r\n        var tot_pageviews = 0;\r\n        var tot_visitors = 0;\r\n        var tot_entrances = 0;\r\n        for (var i=0; i<data.length; i++) {\r\n            data[i].property_id = +data[i].property_id;\r\n            if (typeof data[i].date_recorded === 'string') { data[i].date_recorded = parseTime(data[i].date_recorded); }\r\n            data[i].pageviews = +data[i].pageviews;\r\n            data[i].visitors = +data[i].visitors;\r\n            data[i].entrances = +data[i].entrances;\r\n            data[i].avg_time = +data[i].avg_time;\r\n            data[i].bounce_rate = +data[i].bounce_rate;\r\n            data[i].dealer_id = +data[i].dealer_id;\r\n            data[i].tot_pageviews = tot_pageviews += data[i].pageviews;\r\n            data[i].tot_visitors = tot_visitors += data[i].visitors;\r\n            data[i].tot_entrances = tot_entrances += data[i].entrances;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    function metricReadouts(d) {\r\n        d3.select('#pageviews-readout')\r\n            .transition().duration(prms.duration)\r\n            .tween('text', function() {\r\n                var element = d3.select(this);\r\n                var f = d3.format(',.0f');\r\n                var newValue = d[d.length - 1].tot_pageviews - d[0].tot_pageviews + d[0].pageviews;\r\n                var i = d3.interpolateNumber(element.text().replace(/,/g, ''), newValue);\r\n                return function(t) {\r\n                    element.text(f(i(t)));\r\n                };\r\n            });\r\n        d3.select('#visitors-readout')\r\n            .transition().duration(prms.duration)\r\n            .tween('text', function() {\r\n                var element = d3.select(this);\r\n                var f = d3.format(',.0f');\r\n                var newValue = d[d.length - 1].tot_visitors - d[0].tot_visitors + d[0].visitors;\r\n                var i = d3.interpolateNumber(element.text().replace(/,/g, ''), newValue);\r\n                return function(t) {\r\n                    element.text(f(i(t)));\r\n                };\r\n            });\r\n        d3.select('#entrances-readout')\r\n            .transition().duration(prms.duration)\r\n            .tween('text', function() {\r\n                var element = d3.select(this);\r\n                var f = d3.format(',.0f');\r\n                var newValue = d[d.length - 1].tot_entrances - d[0].tot_entrances + d[0].entrances;\r\n                var i = d3.interpolateNumber(element.text().replace(/,/g, ''), newValue);\r\n                return function(t) {\r\n                    element.text(f(i(t)));\r\n                };\r\n            });  \r\n        d3.select('#duration-readout')\r\n            .transition().duration(prms.duration)\r\n            .tween('text', function() {\r\n                var element = d3.select(this);\r\n                var avg_time = 0;\r\n                for (var i=0; i<d.length; i++) {\r\n                    avg_time += Number(d[i].avg_time);\r\n                }\r\n                var avg_seconds = Math.floor(avg_time / d.length);\r\n                var makeTime = function(time) {\r\n                    var min = Math.floor(time / 60);\r\n                    var sec = Math.floor(time - min * 60);\r\n                    return min + ':' + (\"0\" + sec).slice(-2);\r\n                };\r\n                var breakTime = function(time) {\r\n                    time = time.split(':');\r\n                    var min = +time[0];\r\n                    var sec = +time[1];\r\n                    var totalSec = (min * 60) + sec;\r\n                    return totalSec;\r\n                };\r\n                var elementText = element.text();\r\n                var i = d3.interpolateNumber(breakTime(elementText), avg_seconds);\r\n                return function(t) {\r\n                    element.text(makeTime(i(t)));\r\n                };\r\n            });\r\n        d3.select('#bounce-readout')\r\n            .transition().duration(prms.duration)\r\n            .tween('text', function() {\r\n                var element = d3.select(this);\r\n                var bounceRate = 0;\r\n                for (var i=0; i<d.length; i++) {\r\n                    bounceRate += Number(d[i].bounce_rate);\r\n                }\r\n                bounceRate = bounceRate / d.length;\r\n                var f = d3.format('.1f');\r\n                var i = d3.interpolateNumber(element.text().replace(/%/g, ''), bounceRate);\r\n                return function(t) {\r\n                    element.text(f(i(t)) + '%');\r\n                };\r\n            });\r\n    }\r\n   \r\n    //***** Chart rendering & updating *****//\r\n     function createChart() {\r\n        // Chart size, margins\r\n        mainChart = d3.select('.mainChart')\r\n            .attr('width', prms.width)\r\n            .attr('height', prms.height)\r\n        ;\r\n        width = +mainChart.attr('width') - prms.margin.left - prms.margin.right;\r\n        height = +mainChart.attr('height') - prms.margin.top - prms.margin.bottom;\r\n        g = mainChart.append('g')\r\n            .attr('transform', 'translate(' + prms.margin.left + ',' + prms.margin.top + ')')\r\n            .attr('overflow', 'visible');\r\n        g.append(\"g\")\r\n            .attr('class', 'xAxis')\r\n            .attr(\"transform\", \"translate(0,\" + height + \")\");\r\n        g.append(\"g\")\r\n            .attr('class', 'yAxis');\r\n        var g2 = g.append('g')\r\n            .attr('opacity', prms.dataLines.opacity);\r\n        function addPath(lineClass, txt, txtId, color) {\r\n            g2.append(\"path\")\r\n                .attr('class', lineClass)\r\n                .attr(\"fill\", color)\r\n                .attr(\"stroke\", 'black')\r\n                .attr(\"stroke-width\", prms.dataLines.lineWidth)\r\n            ;\r\n        }\r\n        addPath('pageviews', 'Pageviews', 'pageviewsText', prms.dataLines.pageViewColor);\r\n        addPath('visitors', 'Visitors', 'visitorsText', prms.dataLines.uniqueVisitorColor);\r\n        addPath('entrances', 'Entrances', 'entrancesText', prms.dataLines.entrancesColor);\r\n\r\n        initializeDateSlider();\r\n        updateChart(dataset);\r\n        detailTables(dataset);\r\n    };\r\n    \r\n    function updateChart(d) {\r\n        var svg = mainChart.transition();\r\n        // Define the D3 scales\r\n        xScale = d3.scaleTime()\r\n            .range([0, width])\r\n            .domain(d3.extent(d.map(function(d) { return d.date_recorded; })))\r\n        ;\r\n        var yDomainMin = d3.min(d.map(function(d) { return d.tot_entrances; }));\r\n        var yDomainMax = d3.max(d.map(function(d) { return d.tot_pageviews; }));\r\n        yScale = d3.scaleLinear()\r\n            .range([height, 0])\r\n            .domain([yDomainMin, yDomainMax * 1.1])\r\n        ;\r\n        // Axes\r\n        var formatDay = d3.timeFormat(\"%a %d\"),\r\n            formatWeek = d3.timeFormat(\"%b %d\"),\r\n            formatMonth = d3.timeFormat(\"%b\"),\r\n            formatYear = d3.timeFormat(\"%Y\");\r\n        function multiFormat(date) {\r\n          return (d3.timeMonth(date) < date ? (d3.timeWeek(date) < date ? formatDay : formatWeek)\r\n              : d3.timeYear(date) < date ? formatMonth\r\n              : formatYear)(date);\r\n        }\r\n        bottomAxis = function() {\r\n            return d3.axisBottom(xScale)\r\n                .ticks(7)\r\n                .tickFormat(multiFormat)\r\n                .tickPadding(10)\r\n                .tickSizeInner((-1 * height))\r\n                .tickSizeOuter(0)\r\n            ;\r\n        };\r\n        svg.select('.xAxis')\r\n            .duration(prms.duration)\r\n            .call(bottomAxis())\r\n        ;\r\n        leftAxis = function() {\r\n            return d3.axisLeft(yScale)\r\n                .ticks(8)\r\n                .tickPadding(10)\r\n                .tickSizeInner(-1 * width)\r\n                .tickSizeOuter(0)\r\n            ;\r\n        };\r\n        svg.select('.yAxis')\r\n            .duration(prms.duration)\r\n            .call(leftAxis())\r\n        ;\r\n        // Do the transitions\r\n        lineTransitions(d,'tot_pageviews', '.pageviews', '#pageviewsText');\r\n        lineTransitions(d, 'tot_visitors', '.visitors', '#visitorsText');\r\n        lineTransitions(d, 'tot_entrances', '.entrances', '#entrancesText');\r\n        \r\n        svg.select('#startDateGuide')\r\n            .duration(prms.duration)\r\n            .attr('width', xScale(d[0].date_recorded))\r\n        ;\r\n        svg.select('#endDateGuide')\r\n            .duration(prms.duration)\r\n            .attr('width', width - xScale(d[d.length - 1].date_recorded))\r\n            .attr('x', xScale(d[d.length - 1].date_recorded))\r\n        ;\r\n        metricReadouts(d);\r\n        updateSiteSelect(dataset);\r\n        updateSubheads(d);\r\n        formatTicks();\r\n    }\r\n    function lineTransitions(d, dataCol, lineClass, txtId) {\r\n        var lineD = d3.area()\r\n            .x(function(d) { return xScale(d.date_recorded); })\r\n            .y1(function(d) { return yScale(d[dataCol]); });\r\n        lineD.y0(yScale(0));\r\n        lineD = lineD(d);\r\n        var originalPath = lineD.substring(1, lineD.length-1);\r\n        originalPath = originalPath.split('L');\r\n        var pathCoordinates1 = [];\r\n        var pathCoordinates2 = [];\r\n        var endLine = '';\r\n        var secondSegment = false;\r\n        var lineLength = originalPath.length;\r\n        for (var i=0; i<lineLength; i++) {\r\n            var coords = originalPath[i].split(',');\r\n            coords[0] = Number(coords[0]);\r\n            coords[1] = Number(coords[1]);\r\n            var coordsObj = {x: coords[0], y: coords[1]};\r\n            if ((coords[0] < width) && (!secondSegment)) {\r\n                pathCoordinates1.push(coordsObj);\r\n            } else if (coords[0] === width) {\r\n                secondSegment = true;\r\n                endLine += originalPath[i] + 'L';\r\n            } else if (secondSegment) {\r\n                pathCoordinates2.push(coordsObj);\r\n            }\r\n        }\r\n        pathCoordinates1 = simplify(pathCoordinates1, .5);\r\n        pathCoordinates2 = simplify(pathCoordinates2, .5);\r\n        var increment = pathCoordinates2[0]['x'] / pathCoordinates1.length;\r\n        for (var i=1; i<=pathCoordinates1.length - 1; i++) {\r\n            var item = {x: pathCoordinates2[0]['x'] - increment * i, y: pathCoordinates2[0]['y']};\r\n            pathCoordinates2.splice(i, 0, item);\r\n        }\r\n        lineD = 'M';\r\n        for (var i=0; i<pathCoordinates1.length; i++) {\r\n            lineD += pathCoordinates1[i]['x'] + ',' + pathCoordinates1[i]['y'] + 'L';\r\n        }\r\n        lineD += endLine;\r\n        for (var i=0; i<pathCoordinates2.length; i++) {\r\n            lineD += pathCoordinates2[i]['x'] + ',' + pathCoordinates2[i]['y'] + 'L';\r\n        }\r\n        lineD = lineD.substring(0, lineD.length-1) + 'Z';\r\n        mainChart.transition().select(lineClass)\r\n            .duration(prms.duration)\r\n            .attrTween('d', function() {\r\n                var previous = d3.select(this).attr('d') || lineD;\r\n                var current = lineD;\r\n                function exclude(a, b) {\r\n                    return a.x === b.x;\r\n                }\r\n                return d3.interpolatePath(previous, current, exclude);\r\n            });\r\n        mainChart.transition().select(txtId)\r\n            .duration(prms.duration)\r\n            .attr(\"transform\", \"translate(\"+(width+3)+\",\"+yScale(d[d.length - 1][dataCol])+\")\")\r\n        ;   \r\n    }  \r\n    function formatTicks() {\r\n        d3.selectAll('.yAxis .tick line')\r\n            .attr('stroke-dasharray', '4,2')\r\n            .attr('stroke', 'gray')\r\n        ;\r\n        d3.selectAll('.xAxis .tick line')\r\n            .attr('stroke', 'lightgray')\r\n        ;\r\n        d3.selectAll('.yAxis .tick text')\r\n            .style('font-size', '14px');\r\n        d3.selectAll('.xAxis .tick text')\r\n            .style('font-size', '14px');\r\n        d3.timer(function() {\r\n            d3.selectAll('.xAxis .tick > text')\r\n            .style('font-weight', function() {\r\n                var el = d3.select(this);\r\n                if (!isNaN(el.text())) { return 'bold'; } else { return ''; }\r\n            });\r\n        }, 100);\r\n    };\r\n    var resizeId;\r\n    d3.select(window).on('resize', function() {\r\n        clearTimeout(resizeId);\r\n        resizeId = setTimeout(resize, 100);\r\n    });\r\n    function resize() {\r\n        prms.width = parseInt(d3.select('#chart-box #chart').style('width'), 10);\r\n        mainChart.attr('width', prms.width).attr('height', prms.height);\r\n        width = +mainChart.attr('width') - prms.margin.left - prms.margin.right;\r\n        height = +mainChart.attr('height') - prms.margin.top - prms.margin.bottom;\r\n        updateChart(dataSubset);\r\n    }\r\n    return {\r\n        init: function(url, dealers) {\r\n            ajaxUrl = url;\r\n            dealersList = dealers;\r\n            changeData(createChart);\r\n            initUi();\r\n        }\r\n    };\r\n})();\n\n\n// WEBPACK FOOTER //\n// ./web/js/dashboard.js"],"sourceRoot":""}